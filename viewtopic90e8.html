<!DOCTYPE html>
<html dir="ltr" lang="zh-cmn-hans">

<!-- Mirrored from www.hmailserver.org/viewtopic.php?f=3&t=88&view=print  , Sun, 20 Mar 2022 03:24:15 GMT -->
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
<head>  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1885816497771161" crossorigin="anonymous"></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>hMailServer中文论坛 &bull; hmail怎么限制某个用户或组发送邮件到外域</title>

<link href="styles/prosilver/theme/print.css" rel="stylesheet">
<link href="styles/prosilver/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>hMailServer中文论坛</h1>
		<p>hMailServer中文论坛于2014年上线,支持开源与共享.hMailServer是一个运行于Windows系统的,基于GPL授权的,免费的,开源的邮件系统。<br /><a href="index.html">https://www.hmailserver.org/</a></p>

		<h2>hmail怎么限制某个用户或组发送邮件到外域</h2>
		<p><a href="viewtopicdf44.html?f=3&amp;t=88">https://www.hmailserver.org/viewtopic.php?f=3&amp;t=88</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">分页： <strong>1</strong> / <strong>1</strong></div>
					<div class="post">
				<h3>hmail怎么限制某个用户或组发送邮件到外域</h3>
				<div class="date">发表于 : <strong>2015年4月14日, 17:57</strong></div>
				<div class="author">由 <strong>water1986</strong></div>
				<div class="content">有相应的策略吗，谢谢！</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: hmail怎么限制某个用户或组发送邮件到外域</h3>
				<div class="date">发表于 : <strong>2015年4月14日, 22:21</strong></div>
				<div class="author">由 <strong>Hsia</strong></div>
				<div class="content">在EventHandlers.vbs  内加入下面这个，可以限制某个账户发送到外域。<br>

<div class="codebox"><p>代码: <a href="#" onclick="selectCode(this); return false;">全选</a></p><pre><code>Sub OnSMTPData(oClient, oMessage)
   If (oClient.Username &lt;&gt; "") Then
      Const NotPermitted = "test@hmailserver.org"
      Dim i
      If InStr(NotPermitted, oClient.Username) Then
         For i = 0 To oMessage.Recipients.Count -1
            If (Not oMessage.Recipients(i).IsLocalUser) Then
               Result.Value = 2
               Result.Message = "You are only allowed to send internally"
            End If
         Next
      End If
   End If
End Sub</code></pre></div></div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">全部次数是<abbr title="Asia/Shanghai">UTC+08:00</abbr><br />分页： <strong>1</strong> / <strong>1</strong></div>
			<div class="copyright">
				<p>由 <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited 提供支持
				</p>
								<p>Copyright © 2014-2022 <a href="index.html">hMailServer中文论坛</a>
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from www.hmailserver.org/viewtopic.php?f=3&t=88&view=print  , Sun, 20 Mar 2022 03:24:15 GMT -->
</html>
