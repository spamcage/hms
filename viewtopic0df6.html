<!DOCTYPE html>
<html dir="ltr" lang="zh-cmn-hans">

<!-- Mirrored from www.hmailserver.org/viewtopic.php?f=3&t=57&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2022 03:24:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>hMailServer中文论坛 &bull; phpwebadmin 时出现N个错误，求解，谢谢</title>

<link href="styles/prosilver/theme/print.css" rel="stylesheet">
<link href="styles/prosilver/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>hMailServer中文论坛</h1>
		<p>hMailServer中文论坛于2014年上线,支持开源与共享.hMailServer是一个运行于Windows系统的,基于GPL授权的,免费的,开源的邮件系统。<br /><a href="index.html">https://www.hmailserver.org/</a></p>

		<h2>phpwebadmin 时出现N个错误，求解，谢谢</h2>
		<p><a href="viewtopic0deb.html?f=3&amp;t=57">https://www.hmailserver.org/viewtopic.php?f=3&amp;t=57</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">分页： <strong>1</strong> / <strong>1</strong></div>
					<div class="post">
				<h3>phpwebadmin 时出现N个错误，求解，谢谢</h3>
				<div class="date">发表于 : <strong>2015年3月5日, 15:48</strong></div>
				<div class="author">由 <strong>ywknife</strong></div>
				<div class="content">( ! ) Fatal error: Class 'COM' not found in D:\hMailServer\PHPWebAdmin\initialize.php on line 13 <br>
Call Stack <br>
# Time Memory Function Location <br>
1 0.0000 150040 {main}( ) ..\index.php:0 <br>
2 0.0156 159408 require_once( 'D:\hMailServer\PHPWebAdmin\initialize.php' ) ..\index.php:16<br>

<div class="inline-attachment">
			
		
				<dl class="file">
			<dt class="attach-image"><img src="download/fileab5e.jpg?id=103" class="postimage" alt="无标题.jpg" onclick="viewableArea(this);" /></dt>
						<dd>无标题.jpg (47.72 KiB) 查看 9987 次</dd>
		</dl>
		
		
		
			</div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phpwebadmin 时出现这个错误，求解，谢谢</h3>
				<div class="date">发表于 : <strong>2015年3月6日, 09:13</strong></div>
				<div class="author">由 <strong>ywknife</strong></div>
				<div class="content">I am trying to set up hMailServer in "Windows Server 2008 Enterprise Edition Service Pack 1".I've setup hMailServer,Apache,PHP and webmail Interface "AfterLogic webMail" successfully.And all work well.But I am stuck in a problem while I tried to install "PHPWebAdmin"。 Error message as follows :<br>
Fatal error: Class 'COM' not found in E:\Server\wwwroot\PHPWebAdmin\initialize.php on line 13<br>
<br>
<br>
This infomation occurs while visiting "<a href="http://192.168.2.66:8088/PHPWebadmin/" class="postlink">http://192.168.2.66:8088/PHPWebadmin/</a>".<br>
<br>
I've configured PHP configuration file php.ini options as follows:<br>
[PHP]<br>
register_globals = Off<br>
display_errors = Off<br>
<br>
doc_root = "E:/Server/wwwroot"<br>
extension_dir = "E:/Server/php5_4_5/ext"<br>
<br>
[Session]<br>
session.save_path = "E:/Server/php5_4_5/tmp"<br>
<br>
[COM]<br>
com.allow_dcom = true<br>
<br>
<br>
I've also finished these things as hMailServer manual suggests:<br>
DCOM permissions<br>
Overview<br>
By default, IIS6 is not allowed to connect to hMailServer because of the Distributed COM permissions that Windows uses. Also, Apache run as a user account with restricted permissions is not allowed to connect by default.<br>
<br>
Steps<br>
Follow these steps to give IIS or Apache the required permissions to connect to hMailServer using DCOM.<br>
<br>
1.Start DCOM config by selecting Start, Run, enter dcomcnfg.exe and press OK. <br>
2.In the Component Services program, expand the Component Services folder <br>
3.Expand down to Computers | My Computer | DCOM Config <br>
4.Right-click on hMailServer and select properties <br>
5.Select the Security tab <br>
6.Under "Launch and Activation Permissions", select Customize and click on Edit <br>
7.Under "Group or user names", click Add <br>
8.For IIS6: add the built-in anonymous IIS user account <br>
9.For Apache: add the Apache user account <br>
10.Set the Local Launch and Local Activation permissions for this user to Allow <br>
<br>
<br>
Actually,I even tried to give permission to EveryOne in the DCOM configuration.<br>
<br>
Installing PHPWebAdmin is to give users a place to change their email password.<br>
<br>
Enviroment here:Windows Server 2008,Apache2.2,PHP5.4.5.<br>
<br>
Why this problem happen? And How to handle it?<br>
<br>
Thanks a lot!</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phpwebadmin 时出现这个错误，求解，谢谢</h3>
				<div class="date">发表于 : <strong>2015年3月6日, 10:52</strong></div>
				<div class="author">由 <strong>ywknife</strong></div>
				<div class="content">pPHP：Fatal error: Class 'COM' not found in … 的处理办法 <br>
1、首先在windows的“服务”里面检查COM+服务是否已经启动。如果未启动，请启动它。<br>
大概是该服务：Windows Management Instrumentation<br>
<br>
<br>
2、检查php目录ext文件夹下面php_com_dotnet.dll是否存在。（顺便说一下，ext通常作为php程序的扩展目录，在安装php的时候一般已经设置好。否则就应该不仅仅报主题所说的错咯。）<br>
<br>
<br>
3、如果没问题，在php.ini里面加入以下语句：<br>
<br>
<br>
[PHP_COM_DOTNET]<br>
extension=php_com_dotnet.dll<br>
<br>
<br>
4、php.ini中设置<br>
com.allow_dcom = true<br>
<br>
<br>
5.PHP版本<br>
PHP 5.4.5以前的版本，只需要在php.ini中把com.allow_dcom = true打开就可以了，但是5.4.5版本以后，PHP把com/dotnet 模块集成到了一个单独的扩展中，所以需要在php.ini中加一行扩展extension=php_com_dotnet.dll，是加一行，不是打开，默认配置文件中没有这一行的，然后重启IIS或Apache，再次运行就正常了！</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phpwebadmin 时出现这个错误，求解，谢谢</h3>
				<div class="date">发表于 : <strong>2015年3月7日, 22:18</strong></div>
				<div class="author">由 <strong>Hsia</strong></div>
				<div class="content"><a href="viewtopic439d.html?f=4&amp;t=41" class="postlink">viewtopic.php?f=4&amp;t=41</a></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phpwebadmin 时出现这个错误，求解，谢谢</h3>
				<div class="date">发表于 : <strong>2015年3月8日, 16:34</strong></div>
				<div class="author">由 <strong>ywknife</strong></div>
				<div class="content"><span style="color:#FF0000">PHP.INI中<br>
更改为com.allow_dcom = true<br>
加入一行<br>
extension=php_com_dotnet.dll</span><br>
<br>
出现这个错误：<br>
Source: hMailServer COM library<br>
Description: Can't connect to MySQL server on '127.0.0.1' (10061) 之前不会有这个提示的<br>
<br>
估计是HMAILSERVER没有连上MYSQL的数据库，果然：<br>
点击<br>
hMailServer Administrator 出现<br>
<br>
The connection to the database is not available.<br>
Can't connect to MySQL server on '127.0.0.1' (10061)<br>
<br>
请问该如何处理这个新出来的问题</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phpwebadmin 时出现这个错误，求解，谢谢</h3>
				<div class="date">发表于 : <strong>2015年3月8日, 16:39</strong></div>
				<div class="author">由 <strong>ywknife</strong></div>
				<div class="content"><span style="color:#FF0000">接上面用安装程序中的 hMailServer Database Setup 重新设置原数据库后，又能连接了，数据库不用127.0.0.1 用localhost</span>
<div class="inline-attachment">
			
		
				<dl class="file">
			<dt class="attach-image"><img src="download/file4c30.jpg?id=102" class="postimage" alt="2.jpg" onclick="viewableArea(this);" /></dt>
						<dd>2.jpg (30.86 KiB) 查看 9987 次</dd>
		</dl>
		
		
		
			</div>

新问题又来了
<div class="inline-attachment">
			
		
				<dl class="file">
			<dt class="attach-image"><img src="download/file132f.jpg?id=101" class="postimage" alt="1.jpg" onclick="viewableArea(this);" /></dt>
						<dd>1.jpg (87.24 KiB) 查看 9987 次</dd>
		</dl>
		
		
		
			</div>
这个界面中的username 是什么？ password是什么?<br>
<br>
<span style="color:#FF0000">username是administrator 密码是安装hmailserver时设置的密码</span></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phpwebadmin 时出现这个错误，求解，谢谢</h3>
				<div class="date">发表于 : <strong>2015年3月9日, 10:39</strong></div>
				<div class="author">由 <strong>ywknife</strong></div>
				<div class="content">问题又来了<div class="inline-attachment">
			
		
				<dl class="file">
			<dt class="attach-image"><img src="download/file662f.jpg?id=104" class="postimage" alt="4.jpg" onclick="viewableArea(this);" /></dt>
						<dd>4.jpg (57.8 KiB) 查看 9981 次</dd>
		</dl>
		
		
		
			</div>

有没有人知道如何解决啊，谢谢</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phpwebadmin 时出现这个错误，求解，谢谢</h3>
				<div class="date">发表于 : <strong>2015年3月9日, 10:49</strong></div>
				<div class="author">由 <strong>ywknife</strong></div>
				<div class="content">ＦＯＸＭＡＩＬ不能发信，<div class="inline-attachment">
			
		
				<dl class="file">
			<dt class="attach-image"><img src="download/fileec28.jpg?id=106" class="postimage" alt="1231232.jpg" onclick="viewableArea(this);" /></dt>
						<dd>1231232.jpg (16.44 KiB) 查看 9977 次</dd>
		</dl>
		
		
		
			</div>

不能收信（从QQ邮箱往自己邮件服务器的邮箱发信）<div class="inline-attachment">
			
		
				<dl class="file">
			<dt class="attach-image"><img src="download/file294f.jpg?id=105" class="postimage" alt="2222.jpg" onclick="viewableArea(this);" /></dt>
						<dd>2222.jpg (54.49 KiB) 查看 9980 次</dd>
		</dl>
		
		
		
			</div>
求解</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">全部次数是<abbr title="Asia/Shanghai">UTC+08:00</abbr><br />分页： <strong>1</strong> / <strong>1</strong></div>
			<div class="copyright">
				<p>由 <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited 提供支持
				</p>
								<p>Copyright © 2014-2015 <a href="index.html">hMailServer中文论坛</a>
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from www.hmailserver.org/viewtopic.php?f=3&t=57&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2022 03:24:26 GMT -->
</html>
