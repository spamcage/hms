<!DOCTYPE html>
<html dir="ltr" lang="zh-cmn-hans">

<!-- Mirrored from www.hmailserver.org/viewtopic.php?f=4&t=41&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2022 03:19:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>hMailServer中文论坛 &bull; DCOM权限、网页显示：Fatal error: Class 'COM' not found in *******</title>

<link href="styles/prosilver/theme/print.css" rel="stylesheet">
<link href="styles/prosilver/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>hMailServer中文论坛</h1>
		<p>hMailServer中文论坛于2014年上线,支持开源与共享.hMailServer是一个运行于Windows系统的,基于GPL授权的,免费的,开源的邮件系统。<br /><a href="index.html">https://www.hmailserver.org/</a></p>

		<h2>DCOM权限、网页显示：Fatal error: Class 'COM' not found in *******</h2>
		<p><a href="viewtopic439d.html?f=4&amp;t=41">https://www.hmailserver.org/viewtopic.php?f=4&amp;t=41</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">分页： <strong>1</strong> / <strong>1</strong></div>
					<div class="post">
				<h3>DCOM权限、网页显示：Fatal error: Class 'COM' not found in *******</h3>
				<div class="date">发表于 : <strong>2015年2月7日, 12:45</strong></div>
				<div class="author">由 <strong>Hsia</strong></div>
				<div class="content">一、安装phpwebadmin的时候，访问提示DCOM，默认情况下，IIS6不允许连接，因为Windows使用分布式COM权限来hMailServer。此外，Apache的运行与受限制的权限的用户帐户是不允许默认连接。<br>
网页显示：Fatal error: Class 'COM' not found in *******<br>
<strong class="text-strong">步骤</strong><br>
请按照以下步骤给IIS或Apache所需的权限使用DCOM连接到hMailServer。<br>
1.从Windows控制面板，进入管理工具<br>
2.打开组件服务<br>
3.展开组件服务文件夹<br>
4.展开降至计算机|我的电脑| DCOM配置<br>
5.对hMailServer并选择属性右键单击<br>
6.选择安全选项卡<br>
7.在“启动和激活权限”中，选择自定义，然后单击编辑<br>
8.在“组或用户名称”，单击添加<br>
9.对于IIS6：添加内置IIS匿名用户帐户<br>
10.对于Apache：添加Apache用户帐户<br>
11.设置本地启动和本地激活权限此用户允许<br>
官方说明：<a href="https://www.hmailserver.com/documentation/v5.0/?page=ts_setup_phpwebadmin" class="postlink">https://www.hmailserver.com/documentati ... hpwebadmin</a><br>
<br>
没有上面的那么复杂，在php.ini    加上extension=php_com_dotnet.dll   就Ok<br>
<br>
二、IIS处理，这我本人遇到的，然后是处理方法，希望有用。<br>
1.在php.ini    加上extension=php_com_dotnet.dll <br>
2.【开始】--【控制面板】--【管理工具】--【组件服务】--【组件服务】--【计算机】--【我的电脑】--【DCOM 配置】--【hMailServer】，属性--【安全】--【启动和激活权限】--【自定义】--【编辑】--【添加】--【高级】--【立即查找】--添加IIS用户“IIS_IUSRS”--【确定】--勾选“本地激活”--【确定】--【应用】--【确定】<br>
3.重启IIs。<br>
<br>
官方说明：<a href="https://www.hmailserver.com/documentation/v5.0/?page=ts_setup_phpwebadmin" class="postlink">https://www.hmailserver.com/documentati ... hpwebadmin</a></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: DCOM权限、网页显示：Fatal error: Class 'COM' not found in *******</h3>
				<div class="date">发表于 : <strong>2016年3月23日, 14:25</strong></div>
				<div class="author">由 <strong>ainiyli2008</strong></div>
				<div class="content">我补充一下。。。楼主说到的“对于IIS6：添加内置IIS匿名用户帐户10.对于Apache：添加Apache用户帐户”。楼主在下面说到了iis的账户叫IIS_IUSRS，但还有用其他容器的，比如apache、JBOSS、webloigc、等等，一时半会弄不明白到底是哪个账户，所以干脆添加everyone这个账户。不管什么容器。都有权访问。</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: DCOM权限、网页显示：Fatal error: Class 'COM' not found in *******</h3>
				<div class="date">发表于 : <strong>2017年4月20日, 16:00</strong></div>
				<div class="author">由 <strong>jumio</strong></div>
				<div class="content">没有上面的那么复杂，在php.ini 加上extension=php_com_dotnet.dll 就Ok<br>
<br>
这条足够用了。</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: DCOM权限、网页显示：Fatal error: Class 'COM' not found in *******</h3>
				<div class="date">发表于 : <strong>2019年2月25日, 15:33</strong></div>
				<div class="author">由 <strong>18640492028</strong></div>
				<div class="content">Fatal error: Uncaught Error: Class 'COM' not found in C:\Program Files\Apache24\htdocs\PHPWebAdmin\initialize.php:17 Stack trace: #0 C:\Program Files\Apache24\htdocs\PHPWebAdmin\index.php(23): require_once() #1 {main} thrown in C:\Program Files\Apache24\htdocs\PHPWebAdmin\initialize.php on line 17<br>
<br>
我试了php.ini<br>
register_globals = Off<br>
com.allow_dcom = true<br>
short_open_tag = On<br>
extension_dir = "C:/Program Files/php7.3/ext"<br>
[PHP_COM_DOTNET]<br>
extension = php_com_dotnet.dll<br>
以上我都试了，还有在本地激活添加everyone 都没好用过，什么鬼？？？？<br>
<br>
找到原因了，因为php版本不对，php5.6以后就不支持php_com_dotnet.dll的用法</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">全部次数是<abbr title="Asia/Shanghai">UTC+08:00</abbr><br />分页： <strong>1</strong> / <strong>1</strong></div>
			<div class="copyright">
				<p>由 <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited 提供支持
				</p>
								<p>Copyright © 2014-2015 <a href="index.html">hMailServer中文论坛</a>
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from www.hmailserver.org/viewtopic.php?f=4&t=41&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2022 03:19:28 GMT -->
</html>
